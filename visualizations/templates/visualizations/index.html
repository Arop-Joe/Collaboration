<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Information Visualization</title>
    {% load staticfiles %}
    <!--JavaScript -->
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="{% static 'js/worker.js' %}" charset="utf-8"></script>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" />

  </head>
  <body>
    <canvas id="network" width="500" height="500"></canvas>

    <script>
      var graph = {
        nodes: [
          {name: "John", age:36},
          {name: "Mathew", age:16},
          {name: "Caesar", age:20},
          {name: "Alice", age:19},
          {name: "Bob", age:16},
          {name: "Trudy", age:22}
        ],
        links: [
          {source: "John", target: "Caesar"},
          {source: "John", target: "Mathew"},
          {source: "Alice", target: "Trudy"},
          {source: "Bob", target: "Trudy"},
          {source: "Caesar", target: "Mathew"}
        ]
      };

      var canvas = d3.select("#network"),
          width = canvas.attr("width"),
          height = canvas.attr("height"),
          r = 20,
          ctx = canvas.node().getContext("2d");
          simulation = d3.forceSimulation()
                        .force("x", d3.forceX(width/2))
                        .force("y", d3.forceY(height/2))
                        .force("collide", d3.forceCollide(r+1))
                        .force("charge", d3.forceManyBody()
                                .strength(-200))
                        .on("tick", update);

      // graph.nodes.forEach(function (d) {
      //   d.x = Math.random() * width;
      //   d.y = Math.random() * height;
      // })

      simulation.nodes(graph.nodes);

      function update() {
        ctx.clearRect(0, 0, width, height);

        ctx.beginPath();
        graph.nodes.forEach(drawNode);
        ctx.fill();
      }

      function drawNode(d) {
        ctx.moveTo(d.x, d.y);
        ctx.arc(d.x, d.y, r, 0, 2*Math.PI);
      }

      function drawLink(l) {
        ctx.moveTo(l.x, l.y);
        ctx.arc(d.x, d.y, r, 0, 2*Math.PI);
      }

      update();
    </script>
  </body>

  <!--JavaScript -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
</html>
